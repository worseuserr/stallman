#!/bin/python3

import subprocess
import time
import signal

def set(value):
	subprocess.run(["xrandr", "--output", "eDP", "--gamma", str(round(value, 3)), "--brightness", str(round(value, 3))]);

def quit(signum, frame):
	# fix before exit
	set(1);
	exit(0);
signal.signal(signal.SIGINT, quit);
signal.signal(signal.SIGTERM, quit);

val = 1;
by = 0.001;		# amount of gamma decrease per iteration
t = 0.3; 		# time in seconds between iterations
fixdelay = 1; 	# time in seconds when gamma reaches 0 until it gets set back to 1

time.sleep(50);
while (True):
	val = 1;
	while (val > 0):
		set(val);
		val -= by;
		time.sleep(t);
	time.sleep(fixdelay);
	set(1);
