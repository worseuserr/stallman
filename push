#!/bin/bash

# always
./remove > /dev/null

TARGET_DIR=$(awk '$1=="SGOINFRE"{print $2}' .config)

if [ ! -d "$TARGET_DIR" ]; then
	echo "sgoinfre not found, wtf??"
	exit 1
fi

SCRIPTS=$(awk '$1=="SCRIPTS"{print $2}' .config)
for file in $SCRIPTS/*.sm; do
	if [ -f "$file" ]; then
		chmod 755 "$file"
		cp "$file" "$TARGET_DIR"
		FILENAME="$TARGET_DIR$(echo $file | sed "s,$SCRIPTS,,")"
		./.internal/parseglobals $FILENAME
		echo "Copied: $file"
	fi
done

echo "All stallman files have been copied."
